% Wed  7 Mar 21:10:13 CET 2018
%% jacobian of the nodal point relation
%% semi-autogenerated
function J = jacobian(obj,h)
	C1 = obj.C(1);
	C2 = obj.C(2);
	w1 = obj.w(1);
	w2 = obj.w(2);
	L1 = obj.L(1);
	L2 = obj.L(2);
	h1 = h(1);
	h2 = h(2);
	k = obj.k;
	n = obj.n;
	m = obj.n;
	Qs0 = obj.Qs0;
	Q0  = obj.Q0;
	J = [ -((3*C1^k*L2^(k/2)*Qs0*h1^((3*k)/2)*k*w1)/(2*C1^k*L2^(k/2)*h1*h1^((3*k)/2)*w1 + 2*C2^k*L1^(k/2)*h1*h2^((3*k)/2)*w2) - (3*C1^(2*k)*L2^k*Qs0*h1^(3*k - 1)*k*w1^2)/(2*(C1^k*L2^(k/2)*h1^((3*k)/2)*w1 + C2^k*L1^(k/2)*h2^((3*k)/2)*w2)^2) + (C1^(n - 1)*L2^(n/2 - 1/2)*Q0^(n - 1)*h1^(n/2 - 1)*m*n*w1*(2*C1^2*L2*Q0*h1^(3/2)*w1 - C1*C2*L1^(1/2)*L2^(1/2)*Q0*h2^(3/2)*w2))/(2*(C1*L2^(1/2)*h1^(3/2)*w1 + C2*L1^(1/2)*h2^(3/2)*w2)^(n + 1)))/(L1*w1), ...
	-((3*C1^(2*k)*L2^k*Qs0*h1^(3*k)*k*w1^2)/(2*h2*(C1^k*L2^(k/2)*h1^((3*k)/2)*w1 + C2^k*L1^(k/2)*h2^((3*k)/2)*w2)^2) - (3*C1^k*L2^(k/2)*Qs0*h1^((3*k)/2)*k*w1)/(2*C1^k*L2^(k/2)*h1^((3*k)/2)*h2*w1 + 2*C2^k*L1^(k/2)*h2*h2^((3*k)/2)*w2) + (3*C1^n*C2*L1^(1/2)*L2^(n/2)*Q0^n*h1^(n/2)*h2^(1/2)*m*n*w1*w2)/(2*(C1*L2^(1/2)*h1^(3/2)*w1 + C2*L1^(1/2)*h2^(3/2)*w2)^(n + 1)))/(L1*w1); ...
                                                                                                                                                      ((3*C1^k*C2^k*L1^(k/2)*L2^(k/2)*Qs0*h1^((3*k)/2 - 1)*h2^((3*k)/2)*k*w1*w2)/(2*(C1^k*L2^(k/2)*h1^((3*k)/2)*w1 + C2^k*L1^(k/2)*h2^((3*k)/2)*w2)^2) - (3*C1*C2^n*L1^(n/2)*L2^(1/2)*Q0^n*h1^(1/2)*h2^(n/2)*m*n*w1*w2)/(2*(C1*L2^(1/2)*h1^(3/2)*w1 + C2*L1^(1/2)*h2^(3/2)*w2)^(n + 1)))/(L2*w2), ...
	              -((C2^(n - 1)*L1^(n/2 - 1/2)*Q0^(n - 1)*h2^(n/2 - 1)*m*n*w2*(2*C2^2*L1*Q0*h2^(3/2)*w2 - C1*C2*L1^(1/2)*L2^(1/2)*Q0*h1^(3/2)*w1))/(2*(C1*L2^(1/2)*h1^(3/2)*w1 + C2*L1^(1/2)*h2^(3/2)*w2)^(n + 1)) + (3*C1^k*L2^(k/2)*Qs0*h1^((3*k)/2)*k*w1)/(2*C2^k*L1^(k/2)*h2^((3*k)/2 + 1)*w2*((C1^k*L2^(k/2)*h1^((3*k)/2)*w1)/(C2^k*L1^(k/2)*h2^((3*k)/2)*w2) + 1)^2))/(L2*w2)]

	A = h.*obj.w;
	J = hessian_from_gradient(@(A) obj.Adot([],A),A);
end

